---
title: "Evolución del número de fallecimientos diarios en el Perú"
subtitle: "Datos del Sistema Informático Nacional de Defunciones, SINADEF"
author: "Raúl Eyzaguirre"
date: '`r format(Sys.time(), "%d/%m/%Y")`'
output: 
  html_document:
    toc: true
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

options(stringsAsFactors = FALSE)
options(digits = 4)

library(ggplot2)
library(st4gi)
library(openxlsx) 
library(httr)
```

```{r descargar, include = FALSE, eval = FALSE}
url.sinadef <- "https://cloud.minsa.gob.pe/s/NctBnHXDnocgWAg/download?path=%2F&files=SINADEF_DATOS_ABIERTOS_30092020.xlsx"
GET(url.sinadef, write_disk("temp.xlsx", overwrite = TRUE))
```

```{r datos, include = FALSE}
full <- read.xlsx("temp.xlsx", sheet = 1, startRow = 4)
full <- full[, c("PAIS.DOMICILIO", "DEPARTAMENTO.DOMICILIO", "PROVINCIA.DOMICILIO",
                 "DISTRITO.DOMICILIO", "FECHA", "AÑO")]
colnames(full) <- c("pais", "departamento", "provincia", "distrito", "fecha", "ano")

# Totales por año

total <- table(full$ano)

# Formato fecha

full$fecha <- as.Date(full$fecha, "%Y-%m-%d")
full$ano <- as.numeric(full$ano)

# A partir del 2020 y hasta un día antes

full <- full[full$fecha >= "2020-01-01" & full$fecha < max(full$fecha), ]

# Eliminar otros paises

full <- full[full$pais == "PERU", ]

# Todas las fechas

ultimo.fecha <- max(full$fecha)
ff <- data.frame(fecha = seq(as.Date("2020-01-01", "%Y-%m-%d"), ultimo.fecha, by = "day"),
                 pais = 0)
```

## 1. Introducción

Los datos del sistema Informático Nacional de Defunciones, SINADEF, pueden descargarse desde [este enlace](http://www.minsa.gob.pe/reunis/data/defunciones_registradas.asp) y cuentan con el registro de defunciones desde el año 2017. En la circunstancia actual, estos datos permiten evaluar el efecto de la epidemia de COVID-19 en el país. Es importante tener en cuenta que podría haber un efecto de cobertura (o falta de cobertura); si se considera una tasa de mortalidad para el país de un 5.6 por mil, el número de fallecidos registrados en Sinadef para los años 2017, 2018 y 2019 sería del 54.2%, 61.8% y 62.9%, respectivamente. Este subregistro no es igual en todas las provincias y distritos; como referencia, en los gráficos siguientes se coloca una lìnea verde indicando el nivel correspondiente a un registro al 100% con una tasa de mortalidad de 5.6 por mil.

## 2. Evolución del número de fallecidos diarios a nivel nacional

```{r peru}
ds <- docomp("count", "pais", "fecha", dfr = full, method = 'slow')

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios a nivel nacional") +
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 32625948 * 0.0056 / 365, linetype = 2, color = 3, size = 1)
```

## 3. Evolución del número de fallecidos diarios por departamento

```{r departamento}
## Amazonas

temp <- full[full$departamento == "AMAZONAS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Amazonas") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 426806 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Ancash

temp <- full[full$departamento == "ANCASH", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Áncash") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 1180638 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Apurimac

temp <- full[full$departamento == "APURIMAC", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Apurimac") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 430736 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Arequipa

temp <- full[full$departamento == "AREQUIPA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Arequipa") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 1497438 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Ayacucho

temp <- full[full$departamento == "AYACUCHO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Ayacucho") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 668213 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Cajamarca

temp <- full[full$departamento == "CAJAMARCA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Cajamarca") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 1435711 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Cusco

temp <- full[full$departamento == "CUSCO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Cusco") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 1357075 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Huancavelica

temp <- full[full$departamento == "HUANCAVELICA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Huancavelica ") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 365317 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Huànuco

temp <- full[full$departamento == "HUANUCO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Huánuco") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 760267 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Ica

temp <- full[full$departamento == "ICA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Ica") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 975182 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Junín

temp <- full[full$departamento == "JUNIN", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Junín") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 1361467 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## La Libertad

temp <- full[full$departamento == "LA LIBERTAD", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de La Libertad") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 2016771 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Lambayeque

temp <- full[full$departamento == "LAMBAYEQUE", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Lambayeque") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 1310785 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Lima

temp <- full[full$departamento %in% c("CALLAO", "LIMA"), ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Lima") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = (10628470 + 1129854) * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Loreto

temp <- full[full$departamento == "LORETO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Loreto") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 1027559 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Madre de Dios

temp <- full[full$departamento == "MADRE DE DIOS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Madre de Dios") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 173811 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Moquegua

temp <- full[full$departamento == "MOQUEGUA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Moquegua") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 192740 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Pasco

temp <- full[full$departamento == "PASCO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Pasco") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 271904 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Piura

temp <- full[full$departamento == "PIURA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Piura") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 2047954 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Puno

temp <- full[full$departamento == "PUNO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Puno") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 1237997 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## San Martín

temp <- full[full$departamento == "SAN MARTIN", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de San Martín") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 899648 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Tacna

temp <- full[full$departamento == "TACNA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Tacna") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 370974 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Tumbes

temp <- full[full$departamento == "TUMBES", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Tumbes") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 251521 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Ucayali

temp <- full[full$departamento == "UCAYALI", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el departamento de Ucayali") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 589110 * 0.0056 / 365, linetype = 2, color = 3, size = 1)
```

## 4. Evolución del número de fallecidos diarios por provincia (más de 130000 habitantes)

```{r provincia}
## Andahuaylas

temp <- full[full$provincia == "ANDAHUAYLAS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Andahuaylas (Apurimac)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 142477 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Arequipa

temp <- full[full$provincia == "AREQUIPA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Arequipa (Arequipa)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 1080635 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Barranca

temp <- full[full$provincia == "BARRANCA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Barranca (Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 144381 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Cajamarca

temp <- full[full$provincia == "CAJAMARCA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Cajamarca (Cajamarca)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 348433 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Callao

temp <- full[full$provincia == "CALLAO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Callao (Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 994494 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Cañete

temp <- full[full$provincia == "CAÑETE", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Cañete (Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 240013 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Chanchamayo

temp <- full[full$provincia == "CHANCHAMAYO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Chanchamayo (Junin)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 151489 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Chiclayo

temp <- full[full$provincia == "CHICLAYO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Chiclayo (Lambayeque)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 799675 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Chincha

temp <- full[full$provincia == "CHINCHA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Chincha (Ica)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 226113 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Chota

temp <- full[full$provincia == "CHOTA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Chota (Cajamarca)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 142984 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Coronel Portillo

temp <- full[full$provincia == "CORONEL PORTILLO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Coronel Portillo (Ucayali)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 384168 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Cusco

temp <- full[full$provincia == "CUSCO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Cusco (Cusco)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 447588 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Huacho

temp <- full[full$provincia == "HUAURA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Huaura (Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 227685 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Huamanga

temp <- full[full$provincia == "HUAMANGA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Huamanga (Ayacucho)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 282194 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Huancayo

temp <- full[full$provincia == "HUANCAYO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Huancayo (Junin)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 545615 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Huánuco

temp <- full[full$provincia == "HUANUCO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Huánuco (Huánuco)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 293397 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Huaral

temp <- full[full$provincia == "HUARAL", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Huaral (Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 183898 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Huaraz

temp <- full[full$provincia == "HUARAZ", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Huaraz (Ancash)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 163936 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Ica

temp <- full[full$provincia == "ICA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Ica (Ica)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 391519 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Jaén

temp <- full[full$provincia == "JAEN", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Jaén (Cajamarca)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 185432 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## La Convención

temp <- full[full$provincia == "LA CONVENCION", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de La Convención (Cusco)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 147148 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Lambayeque

temp <- full[full$provincia == "LAMBAYEQUE", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Lambayeque (Lambayeque)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 391519 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Lima

temp <- full[full$provincia == "LIMA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Lima (Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 8574974 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Maynas

temp <- full[full$provincia == "MAYNAS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Maynas (Loreto)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 479866 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Morropón

temp <- full[full$provincia == "MORROPON", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Morropón (Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 162027 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Pisco

temp <- full[full$provincia == "PISCO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Pisco (Ica)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 150744 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Piura

temp <- full[full$provincia == "PIURA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Piura (Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 799321 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Puno

temp <- full[full$provincia == "PUNO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Puno (Puno)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 219494 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## San Ignacio

temp <- full[full$provincia == "SAN IGNACIO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de San Ignacio (Cajamarca)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 130620 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## San Martín

temp <- full[full$provincia == "SAN MARTIN", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de San Martín (San Martín)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 193095 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## San Román

temp <- full[full$provincia == "SAN ROMAN", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de San Román (Puno)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 307417 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Sánchez Carrión

temp <- full[full$provincia == "SANCHEZ CARRION", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Sánchez Carrión (La Libertad)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 144405 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Santa

temp <- full[full$provincia == "SANTA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Santa (Ancash)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 435807 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Satipo

temp <- full[full$provincia == "SATIPO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Satipo (Junín)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 203985 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Sullana

temp <- full[full$provincia == "SULLANA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Sullana (Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 311454 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Tacna

temp <- full[full$provincia == "TACNA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Tacna (Tacna)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 306363 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Talara

temp <- full[full$provincia == "TALARA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Talara (Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 144150 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Trujillo

temp <- full[full$provincia == "TRUJILLO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Trujillo (La Libertad)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 970016 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Tumbes

temp <- full[full$provincia == "TUMBES", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en la provincia de Tumbes (Tumbes)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 154962 * 0.0056 / 365, linetype = 2, color = 3, size = 1)
```

## 5. Evolución del número de fallecidos diarios por distrito (más de 70000 habitantes)

```{r distrito}
## Alto Selva Alegre

temp <- full[full$distrito == "ALTO SELVA ALEGRE", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Alto Selva Alegre (Arequipa, Arequipa)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 85870 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Amarilis

temp <- full[full$distrito == "AMARILIS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Amarilis (Huánuco, Huánuco)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 81461 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Ate

temp <- full[full$distrito == "ATE", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Ate (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 599196 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Ayacucho

temp <- full[full$distrito == "AYACUCHO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Ayacucho (Huamanga, Ayacucho)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 99427 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Bellavista

temp <- full[full$distrito == "BELLAVISTA" & full$provincia == "CALLAO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Bellavista (Callao, Callao)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 74851 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Breña

temp <- full[full$distrito == "BREÑA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Breña (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 85309 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Cajamarca

temp <- full[full$distrito == "CAJAMARCA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Cajamarca (Cajamarca, Cajamarca)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 218741 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Callao

temp <- full[full$distrito == "CALLAO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Callao (Callao, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 451260 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Callería

temp <- full[full$distrito == "CALLERIA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Calleria (Coronel Portillo, Ucayali)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 149999 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Carabayllo

temp <- full[full$distrito == "CARABAYLLO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Carabayllo (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 333045 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Castilla

temp <- full[full$distrito == "CASTILLA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Castilla (Piura, Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 160201 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Catacaos

temp <- full[full$distrito == "CATACAOS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Catacaos (Piura, Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 75870 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Cayma

temp <- full[full$distrito == "CAYMA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Cayma (Arequipa, Arequipa)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 91935 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Cerro Colorado

temp <- full[full$distrito == "CERRO COLORADO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Cerro Colorado (Arequipa, Arequipa)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 197954 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Chiclayo

temp <- full[full$distrito == "CHICLAYO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Chiclayo (Chiclayo, Lambayeque)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 270496 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Chilca

temp <- full[full$distrito == "CHILCA" & full$provincia == "HUANCAYO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Chilca (Huancayo, Junín)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 91851 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

```

```{r distritopend, eval = FALSE}

## Chimbote

temp <- full[full$distrito == "CHIMBOTE", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Chimbote (Santa, Ancash)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 206213 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Chorrillos

temp <- full[full$distrito == "CHORRILLOS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Chorrillos (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 314241 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Chulucanas

temp <- full[full$distrito == "CHULUCANAS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Chulucanas (Morropón, Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 82521 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Comas

temp <- full[full$distrito == "COMAS" & full$provincia == "LIMA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Comas (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 520450 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Coronel gregorio albarracin lanchipa	

temp <- full[full$distrito == "CORONEL GREGORIO ALBARRACIN LANCHIPA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Coronel Gregorio Albarracin Lanchipa (Tacna, Tacna)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 110417 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Cusco

temp <- full[full$distrito == "CUSCO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Cusco (Cusco, Cusco)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 114630 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## El Agustino

temp <- full[full$distrito == "EL AGUSTINO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de El Agustino (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 198862 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## El Porvenir

temp <- full[full$distrito == "EL PORVENIR" & full$provincia == "TRUJILLO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de El Porvenir (Trujillo, La Libertad)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 190461 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## El Tambo

temp <- full[full$distrito == "EL TAMBO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de El Tambo (Huancayo, Junin)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 166359 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Huaral

temp <- full[full$distrito == "HUARAL", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Huaral (Huaral, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 99915 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Huancayo

temp <- full[full$distrito == "HUANCAYO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Huancayo (Huancayo, Junin)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 119993 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Huánuco

temp <- full[full$distrito == "HUANUCO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Huánuco (Huánuco, Huánuco)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 89502 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Ica

temp <- full[full$distrito == "ICA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Ica (Ica, Ica)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 150280 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Independencia

temp <- full[full$distrito == "INDEPENDENCIA" & full$provincia == "HUARAZ", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Independencia (Huaraz, Ancash)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 76088 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Independencia

temp <- full[full$distrito == "INDEPENDENCIA" & full$provincia == "LIMA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Independencia (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 211360 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Iquitos

temp <- full[full$distrito == "IQUITOS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Iquitos (Maynas, Loreto)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 146853 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Jaen

temp <- full[full$distrito == "JAEN", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Jaén (Jaén, Cajamarca)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 94153 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Jesús María

temp <- full[full$distrito == "JESUS MARIA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Jesús María (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 75359 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## José Leonardo Ortiz

temp <- full[full$distrito == "JOSE LEONARDO ORTIZ", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de José Leonardo Ortiz (Chiclayo, Lambayeque)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 156498 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## José Luis Bustamante y Rivero

temp <- full[full$distrito == "JOSE LUIS BUSTAMANTE Y RIVERO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de José Luis Bustamant y Rivero (Arequipa, Arequipa)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 81829 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Juliaca

temp <- full[full$distrito == "JULIACA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Juliaca (San Román, Puno)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 228726 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## La Esperanza

temp <- full[full$distrito == "LA ESPERANZA" & full$provincia == "TRUJILLO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de La Esperanza (Trujillo, La Libertad)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 189206 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## La Molina

temp <- full[full$distrito == "LA MOLINA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de La Molina (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 140679 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## La Victoria

temp <- full[full$distrito == "LA VICTORIA" & full$provincia == "CHICLAYO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de La Victoria (Chiclayo, Lambayeque)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 90912 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## La Victoria

temp <- full[full$distrito == "LA VICTORIA" & full$provincia == "LIMA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de La Victoria (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 173630 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Lambayeque

temp <- full[full$distrito == "LAMBAYEQUE", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Lambayeque (Lambayeque, Lambayeque)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 71425 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Lima

temp <- full[full$distrito == "LIMA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Lima (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 268352 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Los Olivos

temp <- full[full$distrito == "LOS OLIVOS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Los Olivos (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 325884 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Lurigancho

temp <- full[full$distrito == "LURIGANCHO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Lurigancho (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 240814 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Lurín

temp <- full[full$distrito == "LURIN", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Lurín (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 89195 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Manantay

temp <- full[full$distrito == "MANANTAY", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Manantay (Coronel Portillo, Ucayali)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 87525 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Miraflores

temp <- full[full$distrito == "MIRAFLORES" & full$provincia == "LIMA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Miraflores (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 99337 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Moyobamba

temp <- full[full$distrito == "MOYOBAMBA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Moyobamba (Moyobamba, San Martín)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 76325 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Nuevo Chimbote

temp <- full[full$distrito == "NUEVO CHIMBOTE", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Nuevo Chimbote (Santa, Ancash)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 159321 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Pachacamac

temp <- full[full$distrito == "PACHACAMAC", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Pachacamac (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 110071 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Paita

temp <- full[full$distrito == "PAITA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Paita (Paita, Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 87979 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Pariñas

temp <- full[full$distrito == "PARIÑAS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Pariñas (Talara, Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 98309 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Paucarpata

temp <- full[full$distrito == "PAUCARPATA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Paucarpata (Arequipa, Arequipa)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 131346 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Piura

temp <- full[full$distrito == "PIURA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Piura (Piura, Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 158495 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Pueblo Libre

temp <- full[full$distrito == "PUEBLO LIBRE" & full$provincia == "LIMA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Pueblo Libre (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 83323 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Puenta Piedra

temp <- full[full$distrito == "PUENTE PIEDRA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Puente Piedra (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 329675 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Punchana

temp <- full[full$distrito == "PUNCHANA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Punchana (Maynas, Loreto)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 75210 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Puno

temp <- full[full$distrito == "PUNO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Puno (Puno, Puno)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 135288 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Rimac

temp <- full[full$distrito == "RIMAC", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Rimac (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 174785 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## San Borja

temp <- full[full$distrito == "SAN BORJA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de San Borja (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 113247 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## San Juan Bautista

temp <- full[full$distrito == "SAN JUAN BAUTISTA" & full$provincia == "MAYNAS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de San Juan Bautista (Maynas, Loreto)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 127005 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## San Juan de Lurigancho

temp <- full[full$distrito == "SAN JUAN DE LURIGANCHO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de San Juan de Lurigancho (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 1038495 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## San Juan de Miraflores

temp <- full[full$distrito == "SAN JUAN DE MIRAFLORES", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito San Juan de Miraflores (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 355219 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## San Martín de Porres

temp <- full[full$distrito == "SAN MARTIN DE PORRES", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de San Martín de Porres (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 654083 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## San Miguel

temp <- full[full$distrito == "SAN MIGUEL" & full$provincia == "LIMA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de San Miguel (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 155384 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## San Sebastían

temp <- full[full$distrito == "SAN SEBASTIAN", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de San Sebastían (Cusco, Cusco)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 112536 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Santa Anita

temp <- full[full$distrito == "SANTA ANITA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Santa Anita (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 196214 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Santiago

temp <- full[full$distrito == "SANTIAGO" & full$provincia == "CUSCO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Santiago (Cusco, Cusco)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 94756 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Santiago de Surco

temp <- full[full$distrito == "SANTIAGO DE SURCO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Santiago de Surco (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 329152 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Socabaya

temp <- full[full$distrito == "SOCABAYA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Socabaya (Arequipa, Arequipa)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 75351 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Sullana

temp <- full[full$distrito == "SULLANA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Sullana (Sullana, Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 169335 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Surquillo

temp <- full[full$distrito == "SURQUILLO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Surquillo (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 91023 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Tacna

temp <- full[full$distrito == "TACNA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Tacna (Tacna, Tacna)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 92972 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Tambo Grande

temp <- full[full$distrito == "TAMBO GRANDE", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Tambo Grande (Piura, Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 107495 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Tambopata

temp <- full[full$distrito == "TAMBOPATA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Tambopata (Tambopata, Madre de Dios)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 81925 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Tarapoto

temp <- full[full$distrito == "TARAPOTO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Tarapoto (San Martín, San Martín)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 76122 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Trujillo

temp <- full[full$distrito == "TRUJILLO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Trujillo (Trujillo, La Libertad)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 314939 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Tumbes

temp <- full[full$distrito == "TUMBES", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Tumbes (Tumbes, Tumbes)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 102306 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Veintiseis de Octubre

temp <- full[full$distrito == "VEINTISEIS DE OCTUBRE", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Ventiseis de Octubre (Piura, Piura)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 165779 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Ventanilla

temp <- full[full$distrito == "VENTANILLA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Ventanilla (Callao, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 315600 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Villa el Salvador

temp <- full[full$distrito == "VILLA EL SALVADOR", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Villa el Salvador (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 393254 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Villa María del Triunfo

temp <- full[full$distrito == "VILLA MARIA DEL TRIUNFO", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Villa María del Triunfo (Lima, Lima)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 398433 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Yarinacocha

temp <- full[full$distrito == "YARINACOCHA", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Yarinacocha (Coronel Portillo, Ucayali)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 103941 * 0.0056 / 365, linetype = 2, color = 3, size = 1)

## Yurimaguas

temp <- full[full$distrito == "YURIMAGUAS", ]
ds <- docomp("count", "pais", "fecha", dfr = temp, method = 'slow')
ds <- rbind(ds, ff[!(ff$fecha %in% ds$fecha), ])

ggplot(ds, aes(fecha, pais)) +
  geom_point() +
  labs(x = "Fecha", y = "Número de fallecidos diarios",
       title = "Fallecidos diarios en el distrito de Yurimaguas (Alto Amazonas, Loreto)") + 
  ylim(0, NA) +
  geom_smooth(method = 'gam', formula = y ~ s(x, bs = 'cr', k = 11)) +
  geom_hline(yintercept = 83554 * 0.0056 / 365, linetype = 2, color = 3, size = 1)
```
